<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
<style>
    body {
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    background-color: #f0f0f0;
    margin: 0;
    touch-action: manipulation;
}

.calculator {
    border: 1px solid #ccc;
    border-radius: 10px;
    padding: 20px;
    background-color: #fff;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    width: 320px;
}

#display {
    width: 100%;
    height: 60px;
    font-size: 2em;
    text-align: right;
    margin-bottom: 20px;
    padding: 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    box-sizing: border-box;
}

.buttons {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 10px;
}

.btn {
    padding: 20px;
    font-size: 1.2em;
    border: none;
    border-radius: 5px;
    background-color: #e0e0e0;
    cursor: pointer;
    transition: background-color 0.2s ease;
}

.btn:hover {
    background-color: #d0d0d0;
}

.operator {
    background-color: #ff9500;
    color: white;
}

.operator:hover {
    background-color: #e68a00;
}

.equal {
    background-color: #5cb85c;
    color: white;
    grid-column: span 2;
}

.equal:hover {
    background-color: #4cae4c;
}

#clear {
    background-color: #d9534f;
    color: white;
}

#clear:hover {
    background-color: #c9302c;
}

.special {
    background-color: #f7f7f7;
}

.special:hover {
    background-color: #e0e0e0;
}

</style>
</head>
<body>

    <div class="calculator">
        <input type="text" id="display" readonly>
        <div class="buttons">
            <button class="btn" id="clear" data-value="C">C</button>
            <button class="btn" data-value="(">(</button>
            <button class="btn" data-value=")">)</button>
            <button class="btn operator" id="backspace">←</button>
            <button class="btn" data-value="7">7</button>
            <button class="btn" data-value="8">8</button>
            <button class="btn" data-value="9">9</button>
            <button class="btn operator" data-value="/">/</button>
            <button class="btn" data-value="4">4</button>
            <button class="btn" data-value="5">5</button>
            <button class="btn" data-value="6">6</button>
            <button class="btn operator" data-value="*">*</button>
            <button class="btn" data-value="1">1</button>
            <button class="btn" data-value="2">2</button>
            <button class="btn" data-value="3">3</button>
            <button class="btn operator" data-value="-">-</button>
            <button class="btn special" data-value="x2">x²</button>
            <button class="btn special" data-value="√">√</button>
            <button class="btn" data-value="0">0</button>
            <button class="btn" data-value=".">.</button>
            <button class="btn special" data-value="%">%</button>
            <button class="btn special" data-value="+/-">+/-</button>
            <button class="btn operator" data-value="+">+</button>
            <button class="btn equal" id="calculate" data-value="=">=</button>
        </div>
    </div>

    <script>
     document.addEventListener('DOMContentLoaded', () => {
    const display = document.getElementById('display');
    const buttons = document.querySelectorAll('.btn');
    const backspaceButton = document.getElementById('backspace');

    let currentExpression = '';
    let longPressTimer;
    let longPressInterval;

    const updateDisplay = () => {
        display.value = currentExpression;
    };

    const handleBackspace = () => {
        if (currentExpression.length > 0) {
            currentExpression = currentExpression.slice(0, -1);
            updateDisplay();
        }
    };

    const calculateResult = () => {
        try {
            let expressionToEvaluate = currentExpression
                .replace(/(\d+)%/g, '($1 / 100)')
                .replace(/²/g, '**2')
                .replace(/√(\d+)/g, 'Math.sqrt($1)');
            
            const result = new Function('return ' + expressionToEvaluate)();

            if (isFinite(result)) {
                currentExpression = result.toString();
            } else {
                currentExpression = 'Error';
            }
        } catch (error) {
            currentExpression = 'Error';
        }
    };

    buttons.forEach(button => {
        // Skip the backspace button as it has its own dedicated logic.
        if (button.id === 'backspace') {
            return;
        }

        button.addEventListener('click', () => {
            const value = button.getAttribute('data-value');

            if (value === 'C') {
                currentExpression = '';
            } else if (value === '=') {
                calculateResult();
            } else if (value === '+/-') {
                const lastNumberMatch = currentExpression.match(/(-?\d+\.?\d*)$/);
                if (lastNumberMatch) {
                    const lastNumber = lastNumberMatch[0];
                    const newNumber = parseFloat(lastNumber) * -1;
                    currentExpression = currentExpression.replace(lastNumber, newNumber);
                }
            } else if (value === 'x2') {
                currentExpression += '²';
            } else if (value === '√') {
                currentExpression += '√(';
            } else if (value === '1/x') {
                try {
                    const number = parseFloat(currentExpression);
                    if (!isNaN(number) && number !== 0) {
                        currentExpression = (1 / number).toString();
                    } else {
                        currentExpression = 'Error';
                    }
                } catch (e) {
                    currentExpression = 'Error';
                }
            } else if (value === '%') {
                currentExpression += '%';
            } else {
                currentExpression += value;
            }
            updateDisplay();
        });
    });

    // Backspace continuous delete logic
    backspaceButton.addEventListener('mousedown', (event) => {
        event.preventDefault(); // Prevents default browser behavior
        handleBackspace(); // Initial delete

        longPressTimer = setTimeout(() => {
            longPressInterval = setInterval(handleBackspace, 100);
        }, 500); // 500ms delay before continuous delete starts
    });

    backspaceButton.addEventListener('mouseup', () => {
        clearTimeout(longPressTimer);
        clearInterval(longPressInterval);
    });

    backspaceButton.addEventListener('mouseleave', () => {
        clearTimeout(longPressTimer);
        clearInterval(longPressInterval);
    });

    // Handle keyboard input
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Backspace') {
            handleBackspace();
        } else if (e.key === 'Enter') {
            document.getElementById('calculate').click();
        } else if (e.key.toLowerCase() === 'c') {
            document.getElementById('clear').click();
        } else if (['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '.', '+', '-', '*', '/'].includes(e.key)) {
            currentExpression += e.key;
            updateDisplay();
        }
    });
});


    </script>
</body>
</html>
